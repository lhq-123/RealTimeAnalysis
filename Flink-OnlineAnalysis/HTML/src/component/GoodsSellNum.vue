<template>
	<div id="brandSellNumChart" :style="{ width: '100%', height: '300px', border: '0px #0298F9 solid' }"></div>
</template>

<script>
	import {ajaxGet, intervalTime} from '../api/api.js'
	
	var pathSymbols3 = {
	    baobao: 'path://M1024 904.192q0 12.288-11.264 32.768t-34.304 39.424-56.832 33.28-77.824 14.336l-662.528 0q-45.056 0-78.848-14.336t-56.832-33.28-34.304-39.424-11.264-32.768l90.112-482.304q0-25.6 17.92-43.008t42.496-17.408q7.168 2.048 16.384 5.12 8.192 2.048 19.456 5.12l24.576 7.168 0-79.872q0-61.44 23.552-116.224t64.512-95.232 95.744-64 117.248-23.552 117.248 23.552 95.744 64 64.512 95.232 23.552 116.224l0 79.872 24.576-7.168q11.264-3.072 19.456-5.12 9.216-3.072 16.384-5.12 25.6 0 43.008 17.408t17.408 43.008zM240.64 572.416q25.6 0 43.008-17.408t17.408-43.008q0-17.408-8.192-30.72t-21.504-21.504l0 52.224-60.416 0 0-52.224q-29.696 16.384-29.696 52.224 0 25.6 17.408 43.008t41.984 17.408zM271.36 393.216q50.176 11.264 112.64 19.968t128 8.704 128-8.704 113.664-19.968l0-84.992q0-51.2-18.944-96.256t-51.712-78.848-76.8-53.248-94.208-19.456-93.696 19.456-76.288 53.248-51.712 78.848-18.944 96.256l0 84.992zM783.36 572.416q25.6 0 43.008-17.408t17.408-43.008q0-17.408-8.192-30.72t-22.528-21.504l0 52.224-59.392 0 0-52.224q-14.336 8.192-22.528 21.504t-8.192 30.72q0 25.6 17.92 43.008t42.496 17.408z',
	    chongwu: 'path://M1024 212.992q0 70.656-46.08 121.856 46.08 89.088 46.08 193.536 0 96.256-39.936 181.248t-109.568 147.968-162.816 99.328-199.68 36.352-199.68-36.352-162.304-99.328-109.568-147.968-40.448-181.248q0-104.448 46.08-193.536-46.08-51.2-46.08-121.856 0-37.888 13.824-71.168t37.376-58.368 55.808-39.424 68.096-14.336q43.008 0 78.848 18.432t59.392 50.176q46.08-17.408 96.256-26.624t102.4-9.216 102.4 9.216 96.256 26.624q24.576-31.744 59.904-50.176t78.336-18.432q36.864 0 68.608 14.336t55.296 39.424 37.376 58.368 13.824 71.168zM205.824 627.712q10.24 0 18.944-10.24t15.36-28.672 10.24-42.496 3.584-51.712-3.584-51.712-10.24-41.984-15.36-28.16-18.944-10.24q-9.216 0-17.92 10.24t-15.36 28.16-10.752 41.984-4.096 51.712 4.096 51.712 10.752 42.496 15.36 28.672 17.92 10.24zM512 927.744q53.248 0 99.84-13.312t81.408-35.84 54.784-52.736 19.968-65.024q0-33.792-19.968-64t-54.784-52.736-81.408-35.84-99.84-13.312-99.84 13.312-81.408 35.84-54.784 52.736-19.968 64q0 34.816 19.968 65.024t54.784 52.736 81.408 35.84 99.84 13.312zM818.176 627.712q10.24 0 18.944-10.24t15.36-28.672 10.24-42.496 3.584-51.712-3.584-51.712-10.24-41.984-15.36-28.16-18.944-10.24q-9.216 0-17.92 10.24t-15.36 28.16-10.752 41.984-4.096 51.712 4.096 51.712 10.752 42.496 15.36 28.672 17.92 10.24zM512 660.48q39.936 0 68.096 9.728t28.16 24.064-28.16 24.064-68.096 9.728-68.096-9.728-28.16-24.064 28.16-24.064 68.096-9.728z',
	    dazahui: 'path://M466.8416 301.056q-18.432 0-31.744-12.8t-13.312-32.256l0-29.696q0-7.168 3.584-13.824t8.704-14.336 10.24-17.92 7.168-26.624q5.12-17.408 3.072-32.768-1.024-8.192-3.072-15.36 0-18.432 13.312-31.744t31.744-13.312q9.216 0 17.92-0.512t14.848 1.536 9.728 8.704 3.584 20.992q0 18.432-2.56 27.136t-6.144 14.336-8.192 11.264-7.68 16.384-5.12 29.696 0 51.712l0 29.696q0 7.168-13.824 18.432t-32.256 11.264zM286.6176 301.056q-19.456 0-32.256-12.8t-12.8-32.256l0-29.696q0-7.168 3.584-13.824t8.704-14.336 10.24-17.92 7.168-26.624q2.048-8.192 2.56-16.896t-0.512-15.872q-1.024-8.192-2.048-15.36 0-18.432 13.312-31.744t31.744-13.312q9.216 0 17.408-0.512t14.848 1.536 10.24 8.704 3.584 20.992q0 26.624-5.632 35.328t-11.776 17.92-11.264 28.672-3.072 68.608l0 29.696q0 7.168-12.8 18.432t-31.232 11.264zM782.2336 421.888q52.224 0 96.256 12.8t76.288 38.912 50.688 64.512 18.432 90.624-18.432 92.16-50.688 67.072-76.288 41.472-96.256 14.336l-29.696 0q-8.192 58.368-23.552 107.52t-35.84 72.704l-608.256 0q-17.408-8.192-30.208-41.984t-22.016-83.968-14.848-111.616-9.728-124.928q-9.216-147.456-8.192-330.752l782.336 0 0 34.816q0 14.336-0.512 29.696t0.512 26.624zM752.5376 782.336q36.864 0 71.68-10.24t62.464-30.208 44.544-48.64 16.896-64.512q0-72.704-46.08-110.08t-119.808-37.376q0 35.84-2.56 79.36t-6.656 86.016-9.728 78.848-10.752 56.832z',
	    jiaju: 'path://M1024 481.28q0 29.696-10.24 51.2t-25.088 41.472-30.208 40.96-24.576 49.664q-3.072 8.192-5.632 26.112t-5.12 42.496-5.12 53.76-4.608 57.856q-5.12 67.584-10.24 148.48 0 9.216-6.144 15.36-5.12 6.144-17.408 10.752t-35.84 4.608q-24.576 0-41.472-4.608t-28.16-10.752q-12.288-6.144-21.504-15.36l0-29.696-481.28 0 0 29.696q-9.216 9.216-21.504 15.36-11.264 6.144-28.16 10.752t-40.448 4.608q-24.576 0-36.864-4.608t-17.408-10.752q-6.144-6.144-6.144-15.36-5.12-80.896-9.216-148.48-2.048-28.672-4.608-57.856t-5.12-53.76-5.12-42.496-5.632-26.112q-10.24-28.672-25.6-49.664t-30.208-40.96-25.088-41.472-10.24-51.2q0-58.368 41.984-89.6t112.64-31.232q24.576 0 41.984 8.704t30.208 22.528 20.992 31.744 13.312 37.376q-5.12-32.768-15.872-62.464t-33.28-48.128q-11.264-9.216-26.112-17.408t-31.744-15.36-33.792-13.312-30.208-9.216l0-9.216q0-10.24 0.512-33.28t10.24-51.2 33.28-58.88 70.656-55.808 121.344-40.96 185.856-15.872q110.592 0 184.832 15.872t121.344 40.96 71.168 55.808 33.792 58.88 10.24 51.2 0.512 33.28l0 9.216q-13.312 3.072-30.208 8.704t-33.792 12.288-32.256 15.36-25.6 18.944q-17.408 17.408-28.672 45.056 13.312-14.336 33.792-24.576t52.224-10.24q71.68 0 113.152 31.232t41.472 89.6zM752.64 602.112q13.312 0 22.016-8.704t8.704-20.992q0-13.312-8.704-22.016t-22.016-8.704q0-6.144-18.944-16.384t-51.712-19.968-76.288-16.896-93.696-7.168-93.696 7.168-76.288 16.896-51.712 19.968-18.944 16.384q-12.288 0-20.992 8.704t-8.704 22.016q0 12.288 8.704 20.992t20.992 8.704q33.792-16.384 72.704-29.696 32.768-11.264 74.752-20.48t87.04-10.24l2.048 0q46.08 1.024 89.6 10.24t78.336 20.48q40.96 13.312 76.8 29.696z',
	    meishi: 'path://M680.96 546.816l38.912 444.416-569.344-260.096-150.528-477.184 165.888 70.656q-6.144 9.216-9.216 19.456-5.12 24.576 12.8 46.592t47.616 28.16q26.624 5.12 49.664-5.632t31.232-31.232l160.768 69.632q-10.24 12.288-13.312 24.576-5.12 25.6 12.8 46.592t47.616 27.136q28.672 6.144 52.736-6.144t29.184-35.84zM431.104 661.504q8.192-28.672-10.24-55.808t-52.224-36.352q-9.216-3.072-17.408-3.072-17.408-4.096-32.256 0t-25.088 14.336q-20.48 12.288-26.624 34.816-8.192 29.696 10.24 56.32t52.224 35.84q16.384 5.12 33.28 4.096t30.72-7.168 23.552-17.408 13.824-25.6zM960.512 87.04q15.36 36.864 31.744 92.16t24.576 123.904 4.608 148.48-28.16 166.4-75.776 177.152-136.192 180.736l-37.888-436.224q18.432-14.336 52.736-48.128t68.608-89.6 61.952-133.632 33.792-181.248zM900.096 35.84q0 104.448-24.064 183.296t-55.808 134.656-64.512 89.088-49.152 46.592q-5.12-2.048-30.208-12.8t-64-27.648-88.576-38.4-103.936-45.056-109.568-47.104-105.472-45.568-92.672-39.936-70.144-30.208l179.2-35.84 0 6.144q5.12 19.456 27.648 28.16t52.224 2.56 47.616-23.552 13.824-36.864l-2.048-5.12 216.064-44.032 1.024 5.12q4.096 18.432 27.136 27.648t52.736 3.072 47.104-24.064 13.312-36.352l-1.024-3.072 183.296-36.864 0 6.144zM561.152 314.368q31.744 0 53.76-12.288t22.016-29.696-22.016-30.208-53.76-12.8-53.248 12.8-21.504 30.208 21.504 29.696 53.248 12.288z',
	    muying: 'path://M820.224 493.568q17.408 17.408 17.408 43.52t-17.408 44.544l-422.912 423.936q-19.456 17.408-45.568 17.408t-43.52-17.408l-289.792-289.792q-18.432-18.432-18.432-44.032t18.432-45.056l423.936-422.912q18.432-18.432 44.032-18.432t44.032 18.432zM507.904 359.424q9.216-9.216 9.216-22.528t-9.216-21.504q-9.216-9.216-22.016-9.216t-22.016 9.216l-311.296 311.296q-9.216 9.216-9.216 22.528t9.216 22.528 22.016 9.216 22.016-9.216zM919.552 414.72q14.336 14.336 14.336 33.792t-14.336 33.792q-13.312 14.336-32.768 14.336t-33.792-14.336l-311.296-311.296q-14.336-14.336-14.336-33.792t14.336-33.792q13.312-14.336 32.768-14.336t33.792 14.336zM1009.664 81.92q-14.336 13.312-33.28 13.312t-33.28-13.312q19.456 20.48 28.672 46.08t7.168 54.272-14.336 56.832-33.792 52.736l0 1.024q10.24 9.216 10.24 22.016t-10.24 22.016q-9.216 9.216-22.528 9.216t-22.528-9.216l-199.68-199.68q-8.192-9.216-8.192-22.528t9.216-22.528q8.192-10.24 21.504-10.24t22.528 10.24l0 1.024q24.576-22.528 53.248-34.816t57.344-13.824 54.784 7.168 46.592 28.16q-14.336-14.336-14.336-33.28t14.336-32.256q14.336-14.336 33.28-14.336t33.28 14.336q13.312 14.336 13.824 33.792t-13.824 33.792z',
	    shishang: 'path://M921.6 208.896q17.408 24.576 9.216 71.68-3.072 20.48-12.8 47.104t-28.16 61.44-47.616 78.336-72.192 96.768q-7.168 22.528-11.264 41.984-3.072 17.408-2.56 35.328t11.776 30.208q7.168 8.192 19.968 18.944t27.136 28.16 28.16 42.496 23.552 61.44 12.8 86.016-4.096 115.2l-716.8 0q-8.192-65.536-4.608-115.2t13.824-85.504 24.576-60.928 28.672-41.984 26.624-28.16 18.432-20.48q8.192-12.288 9.216-29.696t-1.024-34.816q-3.072-19.456-8.192-40.96-44.032-53.248-74.752-96.768t-50.688-78.848-30.72-62.464-14.848-47.616q-11.264-48.128 5.12-73.728 57.344-30.72 104.448-42.496t81.92-13.824q40.96-2.048 73.728 5.12 20.48-66.56 47.104-98.816t51.2-44.544q28.672-14.336 59.392-11.264 28.672-3.072 56.32 11.264 23.552 12.288 49.152 45.056t46.08 99.328q30.72-7.168 70.656-5.12 33.792 2.048 79.872 13.824t101.376 43.52z',
	    shuma: 'path://M812.032 0q25.6 0 43.52 17.408t17.92 41.984l0 905.216q0 25.6-17.92 42.496t-43.52 16.896l-602.112 0q-24.576 0-41.984-16.896t-17.408-42.496l0-905.216q0-24.576 17.408-41.984t41.984-17.408l602.112 0zM406.528 59.392q-15.36 0-15.36 16.384 0 5.12 4.096 10.24t11.264 5.12l181.248 0q6.144 0 10.752-5.12t4.608-10.24q0-7.168-4.608-11.776t-10.752-4.608l-181.248 0zM512 994.304q24.576 0 43.008-17.92t18.432-42.496q0-25.6-18.432-43.008t-43.008-17.408q-25.6 0-43.008 17.408t-17.408 43.008q0 24.576 17.408 42.496t43.008 17.92zM812.032 210.944q0-25.6-17.408-43.008t-41.984-17.408l-482.304 0q-25.6 0-43.008 17.408t-17.408 43.008l0 571.392q0 25.6 17.408 43.52t43.008 17.92l482.304 0q24.576 0 41.984-17.92t17.408-43.52l0-571.392z',
		yundonghuwai: 'path://M1024 496.64q-82.944-10.24-167.936-53.248t-158.72-116.736-116.224-158.72-53.76-167.936q95.232 3.072 184.832 39.936t162.304 109.568 110.08 162.304 39.424 184.832zM464.896 2.048q11.264 95.232 57.856 190.976t129.536 178.688 178.688 130.048 190.976 58.368q-8.192 87.04-44.544 167.424t-102.912 146.944-146.944 102.912-167.424 44.544q-11.264-95.232-58.368-190.976t-130.048-178.688-178.688-129.536-190.976-57.856q8.192-87.04 45.056-167.936t102.4-147.456q66.56-65.536 147.456-102.4t167.936-45.056zM0 527.36q82.944 11.264 167.936 53.76t158.72 116.224 116.736 158.72 53.248 167.936q-95.232-2.048-184.832-39.424t-162.304-110.08-109.568-162.304-39.936-184.832z'
	};
	
	var goodsTypeToSvgJson = {
		"时尚":pathSymbols3.shishang,
		"美食":pathSymbols3.meishi,
		"运动":pathSymbols3.yundonghuwai,
		"大杂烩":pathSymbols3.dazahui,
		"数码":pathSymbols3.shuma,
		"包包":pathSymbols3.baobao,
		"母婴":pathSymbols3.muying,
		"家居":pathSymbols3.jiaju,
	 };
	
	export default {
		name: 'hello',
		data() {
			return {
				brandSellNumChart : null,
				chartData : {xAxisData:[], hillData:[], glyphData:[]},
				timer : null
			};
		},
		created: function() { //在组件创建完毕后加载
			let _this = this;
			this.timer = setInterval(function () {
				_this.getGoodsTypeTotalNum();
			}, this.GLOBAL_VAR._intervalTime);
		},
		mounted() {
			this.init();
		},
		beforeDestroy() {
		    clearInterval(this.timer);        
		    this.timer = null;
		},
		methods: {
			init() {
				let _this = this;
				this.brandSellNumChart = this.$echarts.init(document.getElementById('brandSellNumChart'));
				this.brandSellNumChart.showLoading();
				this.getGoodsTypeTotalNum();
			},
			getGoodsTypeTotalNum(){
				let _this = this;
				ajaxGet('/api/count/goodsType/totalNum', function(result){
					if (result.code === '1'){
						let data = result.data;
						let xAxisData = [];
						let hillData = [];
						let glyphData = [];
						data.forEach((row, index)=>{
							xAxisData.push(row.name);
							hillData.push(row.value);
							let json = {
								value: row.value,
								symbol: goodsTypeToSvgJson[row.name],
								symbolSize: [35, 35]
							}
							glyphData.push(json);
						})
            console.log('hillData',hillData)
            console.log('glyphData',glyphData)
						_this.chartData = {xAxisData:xAxisData, hillData:hillData, glyphData:glyphData};
						_this.drawLine();
					}
				});
			},
			drawLine() {
				this.brandSellNumChart.hideLoading();
				let option = {
					title: {
						text: '分类销量排名',
            textStyle: {
              color: '#00a4eb',
              fontWeight:'normal'
            }
					},
					tooltip: {
						trigger: 'axis',
						axisPointer: {
							type: 'none'
						},
						formatter: function (params) {
							return params[0].name + ': ' + params[0].value;
						}
					},
					xAxis: {
						//data: ['数码', '美食', '时尚', '家居', '运动', '母婴', '大杂烩', '包包'],
						data: this.chartData.xAxisData,
						axisTick: {show: false},
						axisLine: {show: false},
						axisLabel: {
							color: '#8997b0'
						}
					},
					yAxis: {
						splitLine: {show: false},
						axisTick: {show: true},
						axisLine: {show: true},
						axisLabel: {show: true,color:'#8997b0'}
					},
					grid: {
						top: '30%',
						left: '0%',
						right: '2%',
						bottom: '9%',
						containLabel: true
					},
					color: ['#f88363'],
					series: [{
						name: 'hill',
						type: 'pictorialBar',
						barCategoryGap: '0',
						// symbol: 'path://M0,10 L10,10 L5,0 L0,10 z',
						symbol: 'path://M0,10 L10,10 C5.5,10 5.5,5 5,0 C4.5,5 4.5,10 0,10 z',
						itemStyle: {
              color:'#dbf387',
							// opacity: 0.5
						},
						emphasis: {
							itemStyle: {
								opacity: 1
							}
						},
						//data: [123, 60, 25, 18, 12, 9, 2, 1],
						data: this.chartData.hillData,
						z: 10
					}, {
						name: 'glyph',
						type: 'pictorialBar',
						barGap: '-100%',
						symbolPosition: 'end',
						symbolSize: 50,
						symbolOffset: [0, '-120%'],
						data: this.chartData.glyphData
						
						// data: [{
						// 	value: 123,
						// 	symbol: pathSymbols3.shuma,
						// 	symbolSize: [50, 55]
						// }, {
						// 	value: 60,
						// 	symbol: pathSymbols3.meishi,
						// 	symbolSize: [50, 50]
						// }, {
						// 	value: 25,
						// 	symbol: pathSymbols3.shishang,
						// 	symbolSize: [40, 40]
						// }, {
						// 	value: 18,
						// 	symbol: pathSymbols3.jiaju,
						// 	symbolSize: [35, 35]
						// }, {
						// 	value: 12,
						// 	symbol: pathSymbols3.yundonghuwai,
						// 	symbolSize: [35, 35]
						// }, {
						// 	value: 9,
						// 	symbol: pathSymbols3.muying,
						// 	symbolSize: [35, 35]
						// }, {
						// 	value: 2,
						// 	symbol: pathSymbols3.dazahui,
						// 	symbolSize: [35, 35]
						// }, {
						// 	value: 1,
						// 	symbol: pathSymbols3.baobao,
						// 	symbolSize: [35, 35]
						// }]
					}]
				};
				// 绘制图表
				this.brandSellNumChart.setOption(option);
			}
		}
	};
</script>

<style>
</style>
